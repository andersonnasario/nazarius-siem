# =============================================================================
# Nazarius SIEM - Backend Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values before starting the application.
#
#   cp .env.example .env
#
# IMPORTANT: Never commit the .env file to version control!
# =============================================================================

# --- Required -----------------------------------------------------------

# PostgreSQL
# Generate a strong password: openssl rand -base64 32
POSTGRES_PASSWORD=change-me-to-a-strong-password

# Redis
# Generate a strong password: openssl rand -base64 32
REDIS_PASSWORD=change-me-to-a-strong-password

# JWT Authentication
# Generate a secret: openssl rand -base64 48
JWT_SECRET=change-me-to-a-random-string-at-least-32-characters

# --- Database -----------------------------------------------------------

DB_HOST=localhost
DB_PORT=5432
DB_NAME=siem
DB_USER=siem_user
DB_SSLMODE=disable

# --- Redis --------------------------------------------------------------

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_USE_TLS=false

# --- OpenSearch / Elasticsearch -----------------------------------------

ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_HOST=http://localhost:9200
ELASTICSEARCH_INDEX=siem-*
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_USE_TLS=false

# --- Server -------------------------------------------------------------

PORT=8080
GIN_MODE=debug
CORS_ORIGINS=http://localhost:3000

# --- Data Mode ----------------------------------------------------------

# Set to 'true' to disable demo/mock data and only show real data
DISABLE_MOCK_DATA=false

# --- AWS Integration (optional) ----------------------------------------

# Set to 'true' to connect to real AWS services
USE_REAL_AWS_DATA=false

# AWS credentials (prefer IAM Roles in production)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# AWS_ACCOUNT_ID=

# Security Hub
USE_SECURITY_HUB=false

# CloudTrail S3 Bucket (for centralized log ingestion)
# CLOUDTRAIL_S3_BUCKET=

# VPC Flow Logs
# VPC_FLOWLOGS_S3_BUCKET=
# VPC_FLOWLOGS_S3_PREFIX=

# --- GCP Integration (optional) ----------------------------------------

# Path to GCP Service Account JSON key file
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# --- Cloudflare WAF Integration (optional) ------------------------------

CLOUDFLARE_API_TOKEN=
CLOUDFLARE_ACCOUNT_ID=
CLOUDFLARE_ZONE_IDS=
CLOUDFLARE_ENABLED=false
CLOUDFLARE_SYNC_INTERVAL_MINUTES=5

# --- JumpCloud Integration (optional) ----------------------------------

# Configured via the UI (Settings > JumpCloud)
# Uses OAuth2 Service Account (Client ID + Client Secret)

# --- NVD - National Vulnerability Database (optional) -------------------

# Get a free API key at https://nvd.nist.gov/developers/request-an-api-key
# Increases rate limit from 5 to 50 requests per 30 seconds
NVD_API_KEY=

# --- Automated Response -------------------------------------------------

AUTOMATED_RESPONSE_ENABLED=false

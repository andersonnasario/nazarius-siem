# =============================================================================
# Nazarius SIEM - Backend Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values before starting the application.
#
#   cp .env.example .env
#
# IMPORTANT: Never commit the .env file to version control!
# =============================================================================

# --- Required -----------------------------------------------------------

# PostgreSQL
# Generate a strong password: openssl rand -base64 32
POSTGRES_PASSWORD=change-me-to-a-strong-password

# Redis
# Generate a strong password: openssl rand -base64 32
REDIS_PASSWORD=change-me-to-a-strong-password

# JWT Authentication (REQUIRED - minimum 32 characters)
# Generate a secret: openssl rand -base64 48
JWT_SECRET=change-me-to-a-random-string-at-least-32-characters

# Integration Credentials Encryption Key (recommended)
# Generate: openssl rand -base64 32
# If not set, a random key is generated (credentials won't survive restarts)
# ENCRYPTION_KEY=

# External API Keys (comma-separated, each must be 32+ chars)
# Generate: openssl rand -hex 32
# EXTERNAL_API_KEYS=

# --- Database -----------------------------------------------------------

DB_HOST=localhost
DB_PORT=5432
DB_NAME=siem
DB_USER=siem_user
# DB_PASSWORD is REQUIRED - Generate: openssl rand -base64 32
DB_PASSWORD=change-me-to-a-strong-password
# PRODUCTION: Use 'require' or 'verify-full' for encrypted connections
# Options: disable, allow, prefer, require, verify-ca, verify-full
DB_SSLMODE=disable

# --- Redis --------------------------------------------------------------

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
# PRODUCTION: Set to 'true' to encrypt Redis connections with TLS
REDIS_USE_TLS=false

# --- OpenSearch / Elasticsearch -----------------------------------------

ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_HOST=http://localhost:9200
ELASTICSEARCH_INDEX=siem-*
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
# PRODUCTION: Set to 'true' to encrypt OpenSearch connections with TLS
# Requires valid certificates on the OpenSearch cluster
ELASTICSEARCH_USE_TLS=false

# --- Server -------------------------------------------------------------

PORT=8080
GIN_MODE=debug
# CORS_ORIGINS (comma-separated list of allowed origins)
# IMPORTANT: Do NOT use '*' in production
CORS_ORIGINS=http://localhost:3000

# Trusted Proxies (comma-separated CIDRs for X-Forwarded-For trust)
# TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12

# --- Data Mode ----------------------------------------------------------

# Set to 'true' to disable demo/mock data and only show real data
DISABLE_MOCK_DATA=false

# --- AWS Integration (optional) ----------------------------------------

# Set to 'true' to connect to real AWS services
USE_REAL_AWS_DATA=false

# AWS credentials (prefer IAM Roles in production)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# AWS_ACCOUNT_ID=

# Security Hub
USE_SECURITY_HUB=false

# CloudTrail S3 Bucket (for centralized log ingestion)
# CLOUDTRAIL_S3_BUCKET=

# VPC Flow Logs
# VPC_FLOWLOGS_S3_BUCKET=
# VPC_FLOWLOGS_S3_PREFIX=

# --- GCP Integration (optional) ----------------------------------------

# Path to GCP Service Account JSON key file
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# --- Cloudflare WAF Integration (optional) ------------------------------

CLOUDFLARE_API_TOKEN=
CLOUDFLARE_ACCOUNT_ID=
CLOUDFLARE_ZONE_IDS=
CLOUDFLARE_ENABLED=false
CLOUDFLARE_SYNC_INTERVAL_MINUTES=5

# --- JumpCloud Integration (optional) ----------------------------------

# Configured via the UI (Settings > JumpCloud)
# Uses OAuth2 Service Account (Client ID + Client Secret)

# --- NVD - National Vulnerability Database (optional) -------------------

# Get a free API key at https://nvd.nist.gov/developers/request-an-api-key
# Increases rate limit from 5 to 50 requests per 30 seconds
NVD_API_KEY=

# --- Automated Response -------------------------------------------------

AUTOMATED_RESPONSE_ENABLED=false
